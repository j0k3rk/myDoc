
=== 文件状态变化周期

image:images/file_status_lifecycle.png[file status lifecycle]

=== git

. commit
+
----
// -a:跳过使用暂存区域, -m:message
git commit -a -m 'added new file'

// 撤消刚才的提交操作，可以使用 --amend 选项重新提交：
git commit --amend

// 如果刚才提交时忘了暂存某些修改，可以先补上暂存操作，然后再运行 amend 提交：
git commit -m 'initial commit'
git add forgotten_file
git commit --amend
// 上面的三条命令最终只是产生一个提交，第二个提交命令修正了第一个的提交内容。

// 有两个修改过的文件，想要分开提交，但不小心用 git add 全加到了暂存区域，
// 可以使用 git reset HEAD <file>... 的方式取消暂存
git reset HEAD file.txt
----

. config

.. user
+
----
// 查询
git config --list

// 全局设定
git config --global user.email "YourName@gmail.com"
git config --global user.name "YourName"

// 单项目设定（优先于全局设定）
git config user.email "YourName@gmail.com"
git config user.name "YourName"

// 重置
git config --unset user.name "YourName"
----

.. http.proxy
+
----
// 查询
git config --global --get http.proxy

// 设置网址、用户、密码
git config --global http.proxy http://YOUR_PROXY_USERNAME:YOUR_PROXY_PASSWORD@YOUR.PROXY.SERVER:8080

// 重置
git config --global --unset http.proxy
----

.. gui
+
----
// utf-8
git config --global gui.encoding "utf-8"
----

. log
+
----
// log很长时，bash画面下方的冒号(:)表示还有内容未显示。
// 【J】：向下一行，【K】：向上一行，【Q】：退出
git log

// -p:显示内容差异，-2:仅显示最近的两次更新
git log -p -2

// 仅显示简要的增改行数统计
git log --stat

// format 可以定制要显示的记录格式，这样的输出便于后期编程提取分析
git log --pretty=format:"%h - %an, %ar : %s"
----
+
[cols="^,"]
|===
|选项 | 说明
|%H | 提交对象（commit）的完整哈希字串
|%h | 提交对象的简短哈希字串
|%T | 树对象（tree）的完整哈希字串
|%t | 树对象的简短哈希字串
|%P | 父对象（parent）的完整哈希字串
|%p | 父对象的简短哈希字串
|%an| 作者（author）的名字
|%ae| 作者的电子邮件地址
|%ad| 作者修订日期（可以用 -date= 选项定制格式）
|%ar| 作者修订日期，按多久以前的方式显示
|%cn| 提交者(committer)的名字
|%ce| 提交者的电子邮件地址
|%cd| 提交日期
|%cr| 提交日期，按多久以前的方式显示
|%s | 提交说明
|===
+
其他常用选项及释义：
+
[cols="^,"]
|===
|选项 | 说明
|-p | 按补丁格式显示每个更新之间的差异。
|--word-diff | 按 word diff 格式显示差异。
|--stat | 显示每次更新的文件修改统计信息。
|--shortstat | 只显示 --stat 中最后的行数修改添加移除统计。
|--name-only | 仅在提交信息后显示已修改的文件清单。
|--name-status | 显示新增、修改、删除的文件清单。
|--abbrev-commit | 仅显示 SHA-1 的前几个字符，而非所有的 40 个字符。
|--relative-date | 使用较短的相对时间显示（比如，“2 weeks ago”）。
|--graph | 显示 ASCII 图形表示的分支合并历史。
|--pretty | 使用其他格式显示历史提交信息。可用的选项包括 oneline，short，full，fuller 和 format（后跟指定格式）。
|--oneline | `--pretty=oneline --abbrev-commit` 的简化用法。
|-(n) | 仅显示最近的 n 条提交
|--since, --after |	仅显示指定时间之后的提交，例如：--since=2.weeks
|--until, --before | 仅显示指定时间之前的提交。
|--author | 仅显示指定作者相关的提交。
|--committer | 仅显示指定提交者相关的提交。
|--grep | 搜索提交说明中的关键字
|--all-match | 要得到同时满足两个选项搜索条件的提交，必须用此选项。否则，满足任意一个条件的提交都会被匹配出来。
|===

. mv
+
----
// 移动文件（重命名）
git mv file_from file_to
// 等效于以下三行命令
mv README.txt README
git rm README.txt
git add README
----

. remote
+
----
// 查询
git remote -v

// 增加
git remote add origin http://REMOTE_SERVER:PORT/tfs/Collection/_git/YOUR_PROJECT

// 移除
git remote remove origin
----

. rm
+
----
// 如果删除之前修改过并且已经放到暂存区域的话，则必须要用强制删除选项：-f
git rm -f file.txt


// 想把文件从Git仓库中删除（亦即从暂存区域移除），但仍希望保留在当前工作目录中。
// 换句话说，仅是从跟踪清单中删除。
git rm --cached file.txt
----

== gitk

图形界面，基本上相当于 git log 命令的可视化版本。